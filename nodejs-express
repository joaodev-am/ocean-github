const express = require ("express")
const app = express()

//habilitar o processamento de JSON
app.use(express.json());

//endpoint inicial
app.get("/", function (req, res){
    res.send("Hello World!")
})
//endpoint /oi
app.get("/oi", function (req, res){
    res.send("Olá, Mundo!")
})

//lista
const lista = ["Mulher Maravilha", "Capita Marvel", "Homem de Ferro"];

//Read All -> [GET] /herois
app.get ("/herois", function (req, res){
    res.send(lista.filter(Boolean))
})

//Create -> [POST] /herois
app.post("/herois", function(req, res){
    //debug apenas para verificar se está recebendo a requisiçao corretamente
    console.log (req.body);
    //extrai o corpo da requisiçao
    const item = req.body.nome;
    //inseri o item na lista
    lista.push(item);
    //envia uma resposta de sucesso para o frontend
    res.send("Item adicionado com sucesso!")
})

//Read by ID -> [GET] /herois/:id

app.get("/herois/:id", function (req, res){
    //pegamos inicialmente o parametro de rota(id)
    const id = req.params.id - 1;

    //buscamos a informaçao na lista pelo id
    const item = lista[id];

    //exibimos o item na resposta
    res.send(item);
})

//Update -> [PUT] /herois/:id
app.put("/herois/:id", function (req, res){
    //pegamos inicialmente o parametro de rota(id)
    const id = req.params.id - 1;

    //extrai o corpo da requisiçao
    const item = req.body.nome;

    //atualizamos na lista
    lista[id] = item;

    //exibimos o item na resposta
    res.send("Item adicionado com sucesso!");
})

//Delete -> [DELETE] /herois/:id
app.delete("/herois/:id", function(req,res){
    //pegamos inicialmente o parametro de rota (id) que queremos remover
    const id = req.params.id -1;

    //removemos da lista
    delete lista[id];

    res.send("Item removido com sucesso!");
})
app.listen (3000);
